 ** On entry to cusparseCreate(): CUDA context cannot be initialized

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

0
dataSet      amazon0505
num_nodes        410236
num_edges        410236
NNZ             3356824
Name: 0, dtype: object
amazon0505
1
dataSet      packing-500x100x100-b050
num_nodes                     2145852
num_edges                     2145852
NNZ                          34976486
Name: 1, dtype: object
packing-500x100x100-b050
2
dataSet      com-Orkut
num_nodes      3072441
num_edges      3072441
NNZ          234370166
Name: 2, dtype: object
com-Orkut
3
dataSet      italy_osm
num_nodes      6686493
num_edges      6686493
NNZ           14027956
Name: 3, dtype: object
italy_osm
4
dataSet      road_usa
num_nodes    23947347
num_edges    23947347
NNZ          57708624
Name: 4, dtype: object
road_usa
Execution time:  801.884779214859
dynamic_shared_size: 164
	 GPU Preprocess time: 0.0109555 seconds
TC_Blocks:	315485
Exp_Edges:	40382080
Not supported exe plan!NVIDIA A100-SXM4-40GB
dimN: 64
/home/cunyang/scratch.bhatele-lab/dataset/amazon0505/amazon0505.npz
64-amazon0505 advisor-1.5819
64-amazon0505 tcgnn-1.4874
64-amazon0505 gespmm-0.8859
amazon0505 is success

/home/cunyang/scratch.bhatele-lab/dataset/packing-500x100x100-b050/packing-500x100x100-b050.npz
64-packing-500x100x100-b050 advisor-9.1627
64-packing-500x100x100-b050 gespmm-7.1082
packing-500x100x100-b050 is success

/home/cunyang/scratch.bhatele-lab/dataset/com-Orkut/com-Orkut.npz
64-com-Orkut advisor-90.8957
64-com-Orkut gespmm-52.9913
com-Orkut is success

/home/cunyang/scratch.bhatele-lab/dataset/italy_osm/italy_osm.npz
64-italy_osm advisor-9.8902
64-italy_osm gespmm-6.0414
italy_osm is success

/home/cunyang/scratch.bhatele-lab/dataset/road_usa/road_usa.npz
64-road_usa advisor-43.0311
64-road_usa gespmm-25.2775
road_usa is success

All is success
NVIDIA A100-SXM4-40GB
dimN: 64
64-amazon0505tcu_8_1_balance-0.48
amazon0505 is success

64-packing-500x100x100-b050tcu_8_1_balance-2.59
packing-500x100x100-b050 is success

64-com-Orkuttcu_8_1_balance-37.2
com-Orkut is success

64-italy_osmtcu_8_1_balance-3.81
italy_osm is success

64-road_usatcu_8_1_balance-15.04
road_usa is success

All is success
	 GPU Preprocess time: 0.0883749 seconds
	 GPU Preprocess time: 0.250437 seconds
	 GPU Preprocess time: 0.829001 seconds
	 GPU Preprocess time: 0.0588723 seconds
	 GPU Preprocess time: 0.226287 seconds
 ** On entry to cusparseCreate(): CUDA context cannot be initialized

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

terminate called after throwing an instance of 'std::bad_array_new_length'
  what():  std::bad_array_new_length
/bin/sh: line 1: 3050413 Aborted                 /scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/Baseline/RoDe/build/eval/eval_spmm_f32_inputN 128 /home/cunyang/scratch.bhatele-lab/dataset/road_usa/road_usa.mtx >> /scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/result/Baseline/spmm/A100_rode_sputnik_cusparse_spmm_f32_n128.csv
0
dataSet      amazon0505
num_nodes        410236
num_edges        410236
NNZ             3356824
Name: 0, dtype: object
amazon0505
1
dataSet      packing-500x100x100-b050
num_nodes                     2145852
num_edges                     2145852
NNZ                          34976486
Name: 1, dtype: object
packing-500x100x100-b050
2
dataSet      com-Orkut
num_nodes      3072441
num_edges      3072441
NNZ          234370166
Name: 2, dtype: object
com-Orkut
3
dataSet      italy_osm
num_nodes      6686493
num_edges      6686493
NNZ           14027956
Name: 3, dtype: object
italy_osm
4
dataSet      road_usa
num_nodes    23947347
num_edges    23947347
NNZ          57708624
Name: 4, dtype: object
road_usa
Execution time:  587.3292236328125
dynamic_shared_size: 164
	 GPU Preprocess time: 0.00565499 seconds
TC_Blocks:	315485
Exp_Edges:	40382080
dynamic_shared_size: 172
	 GPU Preprocess time: 0.0535847 seconds
TC_Blocks:	2423307
Exp_Edges:	310183296
dynamic_shared_size: 60012
	 GPU Preprocess time: 0.556129 seconds
TC_Blocks:	26269125
Exp_Edges:	-932519296
dynamic_shared_size: 68
	 GPU Preprocess time: 0.01337 seconds
TC_Blocks:	1344528
Exp_Edges:	172099584
dynamic_shared_size: 68
dimN: 128
amazon0505
amazon0505
packing-500x100x100-b050
packing-500x100x100-b050
com-Orkut
com-Orkut
italy_osm
italy_osm
road_usa
road_usa
	 GPU Preprocess time: 0.0595452 seconds
TC_Blocks:	6955459
Exp_Edges:	890298752
NVIDIA A100-SXM4-40GB
dimN: 128
/home/cunyang/scratch.bhatele-lab/dataset/amazon0505/amazon0505.npz
128-amazon0505 advisor-2.0337
128-amazon0505 tcgnn-2.1139
128-amazon0505 gespmm-1.0933
amazon0505 is success

/home/cunyang/scratch.bhatele-lab/dataset/packing-500x100x100-b050/packing-500x100x100-b050.npz
128-packing-500x100x100-b050 advisor-10.9855
128-packing-500x100x100-b050 gespmm-7.4314
packing-500x100x100-b050 is success

/home/cunyang/scratch.bhatele-lab/dataset/com-Orkut/com-Orkut.npz
128-com-Orkut advisor-108.9305
128-com-Orkut gespmm-71.7192
com-Orkut is success

/home/cunyang/scratch.bhatele-lab/dataset/italy_osm/italy_osm.npz
128-italy_osm advisor-14.6212
128-italy_osm gespmm-9.8097
italy_osm is success

/home/cunyang/scratch.bhatele-lab/dataset/road_usa/road_usa.npz
Subprocess failed: Traceback (most recent call last):
  File "/scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/eva/kernel/spmm/advisor/test_advisor.py", line 48, in <module>
    res = test(data, epoches, dimN, data_path)
  File "/scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/eva/kernel/spmm/advisor/test_advisor.py", line 38, in test
    execution_time = kernel(inputInfo, epoches, dataset)
  File "/scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/eva/kernel/spmm/advisor/test_advisor.py", line 11, in kernel
    X_prime, spmm_ms_avg = GNNAdvisor_kernel.forward(dataset.x, inputInfo.row_pointers, inputInfo.column_index, inputInfo.degrees, inputInfo.partPtr, inputInfo.part2Node, inputInfo.partSize, inputInfo.dimWorker, inputInfo.warpPerBlock, epoches, 10)
RuntimeError: numel needs to be smaller than int32_t max; otherwise, please use packed_accessor64

128-road_usa advisor-100000
128-road_usa gespmm-0.0
road_usa is success

All is success
NVIDIA A100-SXM4-40GB
dimN: 128
128-amazon0505tcu_8_1_balance-1.0
amazon0505 is success

128-packing-500x100x100-b050tcu_8_1_balance-4.91
packing-500x100x100-b050 is success

128-com-Orkuttcu_8_1_balance-73.14
com-Orkut is success

128-italy_osmtcu_8_1_balance-6.81
italy_osm is success

128-road_usatcu_8_1_balance-28.95
road_usa is success

All is success
	 GPU Preprocess time: 0.122585 seconds
	 GPU Preprocess time: 0.185013 seconds
	 GPU Preprocess time: 1.59129 seconds
	 GPU Preprocess time: 0.102567 seconds
	 GPU Preprocess time: 0.279162 seconds
 ** On entry to cusparseCreate(): CUDA context cannot be initialized

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseCreate(): CUDA context cannot be initialized

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseCreate(): CUDA context cannot be initialized

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

/bin/sh: line 1: 3056301 Segmentation fault      /scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/Baseline/RoDe/build/eval/eval_spmm_f32_inputN 256 /home/cunyang/scratch.bhatele-lab/dataset/road_usa/road_usa.mtx >> /scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/result/Baseline/spmm/A100_rode_sputnik_cusparse_spmm_f32_n256.csv
0
dataSet      amazon0505
num_nodes        410236
num_edges        410236
NNZ             3356824
Name: 0, dtype: object
amazon0505
1
dataSet      packing-500x100x100-b050
num_nodes                     2145852
num_edges                     2145852
NNZ                          34976486
Name: 1, dtype: object
packing-500x100x100-b050
2
dataSet      com-Orkut
num_nodes      3072441
num_edges      3072441
NNZ          234370166
Name: 2, dtype: object
com-Orkut
3
dataSet      italy_osm
num_nodes      6686493
num_edges      6686493
NNZ           14027956
Name: 3, dtype: object
italy_osm
4
dataSet      road_usa
num_nodes    23947347
num_edges    23947347
NNZ          57708624
Name: 4, dtype: object
road_usa
Execution time:  1573.4454896450043
dynamic_shared_size: 164
	 GPU Preprocess time: 0.00549958 seconds
TC_Blocks:	315485
Exp_Edges:	40382080
dynamic_shared_size: 172
	 GPU Preprocess time: 0.033905 seconds
TC_Blocks:	2423307
Exp_Edges:	310183296
dynamic_shared_size: 60012
	 GPU Preprocess time: 0.549356 seconds
TC_Blocks:	26269125
Exp_Edges:	-932519296
dynamic_shared_size: 68
	 GPU Preprocess time: 0.0151206 seconds
TC_Blocks:	1344528
Exp_Edges:	172099584
dynamic_shared_size: 68
dimN: 256
amazon0505
amazon0505
packing-500x100x100-b050
packing-500x100x100-b050
com-Orkut
com-Orkut
italy_osm
italy_osm
road_usa
	 GPU Preprocess time: 0.0596254 seconds
TC_Blocks:	6955459
Exp_Edges:	890298752
Traceback (most recent call last):
  File "/scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/Baseline/DTC-SpMM/run_DTC_SpMM_h100.py", line 90, in <module>
    _, dtc_spmm = DTCSpMM.run_DTCSpMM_balance(X, TCblockRowid, TCblocktileId, TCblockoffset, SparseAToXindex, num_rows, exeplan)
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 22.84 GiB. GPU 0 has a total capacity of 39.50 GiB of which 7.96 GiB is free. Including non-PyTorch memory, this process has 31.53 GiB memory in use. Of the allocated memory 30.27 GiB is allocated by PyTorch, and 794.34 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
NVIDIA A100-SXM4-40GB
dimN: 256
/home/cunyang/scratch.bhatele-lab/dataset/amazon0505/amazon0505.npz
256-amazon0505 advisor-3.3475
256-amazon0505 tcgnn-2.1994
256-amazon0505 gespmm-2.4034
amazon0505 is success

/home/cunyang/scratch.bhatele-lab/dataset/packing-500x100x100-b050/packing-500x100x100-b050.npz
256-packing-500x100x100-b050 advisor-19.6691
256-packing-500x100x100-b050 gespmm-13.4228
packing-500x100x100-b050 is success

/home/cunyang/scratch.bhatele-lab/dataset/com-Orkut/com-Orkut.npz
256-com-Orkut advisor-202.6155
256-com-Orkut gespmm-143.4861
com-Orkut is success

/home/cunyang/scratch.bhatele-lab/dataset/italy_osm/italy_osm.npz
256-italy_osm advisor-27.0649
256-italy_osm gespmm-19.4417
italy_osm is success

/home/cunyang/scratch.bhatele-lab/dataset/road_usa/road_usa.npz
Subprocess failed: Traceback (most recent call last):
  File "/scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/eva/kernel/spmm/advisor/test_advisor.py", line 48, in <module>
    res = test(data, epoches, dimN, data_path)
  File "/scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/eva/kernel/spmm/advisor/test_advisor.py", line 18, in test
    dataset.to(device)
  File "/scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/eva/kernel/spmm/advisor/mdataset.py", line 99, in to
    self.x =  self.x.to(device)
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 22.84 GiB. GPU 0 has a total capacity of 39.50 GiB of which 15.04 GiB is free. Process 3057953 has 24.04 GiB memory in use. Including non-PyTorch memory, this process has 414.00 MiB memory in use. Of the allocated memory 0 bytes is allocated by PyTorch, and 0 bytes is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

256-road_usa advisor-100000
Traceback (most recent call last):
  File "/scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/eva/kernel/spmm/spmm_baselines.py", line 116, in <module>
    spmm_gespmm = gespmm_test(row.iloc[0], dimN, epoches, data_path)
  File "/scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/eva/kernel/spmm/spmm_baselines.py", line 36, in gespmm_test
    spmm = test_gespmm.test(data, epoches, dimN, data_path)
  File "/scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/eva/kernel/spmm/gespmm/test_gespmm.py", line 22, in test
    execution_time = kernel(inputInfo, epoches)
  File "/scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/eva/kernel/spmm/gespmm/test_gespmm.py", line 11, in kernel
    X_prime, spmm_ms_avg = GESpMM_kernel.forward(inputInfo.row_pointers, inputInfo.column_index, inputInfo.values, 
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 22.84 GiB. GPU 0 has a total capacity of 39.50 GiB of which 15.64 GiB is free. Including non-PyTorch memory, this process has 23.84 GiB memory in use. Of the allocated memory 23.36 GiB is allocated by PyTorch, and 5.64 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
CUDA Runtime Error: out of memory
CUDA Runtime Error: an illegal memory access was encountered
NVIDIA A100-SXM4-40GB
dimN: 256
256-amazon0505tcu_8_1_balance-2.15
amazon0505 is success

256-packing-500x100x100-b050tcu_8_1_balance-8.08
packing-500x100x100-b050 is success

256-com-Orkuttcu_8_1_balance-151.45
com-Orkut is success

256-italy_osmtcu_8_1_balance-13.73
italy_osm is success

256-road_usatcu_8_1_balance-0.0
road_usa is success

All is success
	 GPU Preprocess time: 0.100309 seconds
	 GPU Preprocess time: 0.158239 seconds
	 GPU Preprocess time: 1.08908 seconds
	 GPU Preprocess time: 0.146202 seconds
	 GPU Preprocess time: 0.264624 seconds
 ** On entry to cusparseCreate(): CUDA context cannot be initialized

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseCreate(): CUDA context cannot be initialized

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM_bufferSize() parameter number 1 (handle) had an illegal value: NULL pointer

 ** On entry to cusparseSpMM() parameter number 1 (handle) had an illegal value: NULL pointer

terminate called after throwing an instance of 'std::bad_array_new_length'
  what():  std::bad_array_new_length
/bin/sh: line 1: 3062658 Aborted                 /scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/Baseline/RoDe/build/eval/eval_spmm_f32_inputN 512 /home/cunyang/scratch.bhatele-lab/dataset/italy_osm/italy_osm.mtx >> /scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/result/Baseline/spmm/A100_rode_sputnik_cusparse_spmm_f32_n512.csv
terminate called after throwing an instance of 'std::bad_array_new_length'
  what():  std::bad_array_new_length
/bin/sh: line 1: 3062670 Aborted                 /scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/Baseline/RoDe/build/eval/eval_spmm_f32_inputN 512 /home/cunyang/scratch.bhatele-lab/dataset/road_usa/road_usa.mtx >> /scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/result/Baseline/spmm/A100_rode_sputnik_cusparse_spmm_f32_n512.csv
0
dataSet      amazon0505
num_nodes        410236
num_edges        410236
NNZ             3356824
Name: 0, dtype: object
amazon0505
1
dataSet      packing-500x100x100-b050
num_nodes                     2145852
num_edges                     2145852
NNZ                          34976486
Name: 1, dtype: object
packing-500x100x100-b050
2
dataSet      com-Orkut
num_nodes      3072441
num_edges      3072441
NNZ          234370166
Name: 2, dtype: object
com-Orkut
3
dataSet      italy_osm
num_nodes      6686493
num_edges      6686493
NNZ           14027956
Name: 3, dtype: object
italy_osm
4
dataSet      road_usa
num_nodes    23947347
num_edges    23947347
NNZ          57708624
Name: 4, dtype: object
road_usa
Execution time:  968.5896780490875
dynamic_shared_size: 164
	 GPU Preprocess time: 0.00588606 seconds
TC_Blocks:	315485
Exp_Edges:	40382080
dynamic_shared_size: 172
	 GPU Preprocess time: 0.0461212 seconds
TC_Blocks:	2423307
Exp_Edges:	310183296
dynamic_shared_size: 60012
	 GPU Preprocess time: 0.548951 seconds
TC_Blocks:	26269125
Exp_Edges:	-932519296
dynamic_shared_size: 68
	 GPU Preprocess time: 0.02825 seconds
TC_Blocks:	1344528
Exp_Edges:	172099584
dynamic_shared_size: 68
dimN: 512
amazon0505
amazon0505
packing-500x100x100-b050
packing-500x100x100-b050
com-Orkut
com-Orkut
italy_osm
italy_osm
road_usa
	 GPU Preprocess time: 0.0595788 seconds
TC_Blocks:	6955459
Exp_Edges:	890298752
Traceback (most recent call last):
  File "/scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/Baseline/DTC-SpMM/run_DTC_SpMM_h100.py", line 78, in <module>
    X = torch.ones((num_rows, dimN)).cuda()
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 45.68 GiB. GPU 0 has a total capacity of 39.50 GiB of which 6.42 GiB is free. Including non-PyTorch memory, this process has 33.07 GiB memory in use. Of the allocated memory 26.57 GiB is allocated by PyTorch, and 6.03 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
/var/spool/slurmd/job10396616/slurm_script: line 16: 3063068 Segmentation fault      python spmm_baselines.py $DIMN A100
/var/spool/slurmd/job10396616/slurm_script: line 16: 3064866 Killed                  python spmm_tf32_test_args.py $DIMN A100
terminate called after throwing an instance of 'std::bad_array_new_length'
  what():  std::bad_array_new_length
/bin/sh: line 1: 3065833 Aborted                 /scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/Baseline/RoDe/build/eval/eval_spmm_f32_inputN 1024 /home/cunyang/scratch.bhatele-lab/dataset/packing-500x100x100-b050/packing-500x100x100-b050.mtx >> /scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/result/Baseline/spmm/A100_rode_sputnik_cusparse_spmm_f32_n1024.csv
terminate called after throwing an instance of 'std::bad_array_new_length'
  what():  std::bad_array_new_length
/bin/sh: line 1: 3065857 Aborted                 /scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/Baseline/RoDe/build/eval/eval_spmm_f32_inputN 1024 /home/cunyang/scratch.bhatele-lab/dataset/com-Orkut/com-Orkut.mtx >> /scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/result/Baseline/spmm/A100_rode_sputnik_cusparse_spmm_f32_n1024.csv
terminate called after throwing an instance of 'std::bad_array_new_length'
  what():  std::bad_array_new_length
/bin/sh: line 1: 3065996 Aborted                 /scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/Baseline/RoDe/build/eval/eval_spmm_f32_inputN 1024 /home/cunyang/scratch.bhatele-lab/dataset/italy_osm/italy_osm.mtx >> /scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/result/Baseline/spmm/A100_rode_sputnik_cusparse_spmm_f32_n1024.csv
terminate called after throwing an instance of 'std::bad_array_new_length'
  what():  std::bad_array_new_length
/bin/sh: line 1: 3066014 Aborted                 /scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/Baseline/RoDe/build/eval/eval_spmm_f32_inputN 1024 /home/cunyang/scratch.bhatele-lab/dataset/road_usa/road_usa.mtx >> /scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/result/Baseline/spmm/A100_rode_sputnik_cusparse_spmm_f32_n1024.csv
0
dataSet      amazon0505
num_nodes        410236
num_edges        410236
NNZ             3356824
Name: 0, dtype: object
amazon0505
1
dataSet      packing-500x100x100-b050
num_nodes                     2145852
num_edges                     2145852
NNZ                          34976486
Name: 1, dtype: object
packing-500x100x100-b050
2
dataSet      com-Orkut
num_nodes      3072441
num_edges      3072441
NNZ          234370166
Name: 2, dtype: object
com-Orkut
3
dataSet      italy_osm
num_nodes      6686493
num_edges      6686493
NNZ           14027956
Name: 3, dtype: object
italy_osm
4
dataSet      road_usa
num_nodes    23947347
num_edges    23947347
NNZ          57708624
Name: 4, dtype: object
road_usa
Execution time:  248.7673213481903
dynamic_shared_size: 164
	 GPU Preprocess time: 0.0111126 seconds
TC_Blocks:	315485
Exp_Edges:	40382080
dynamic_shared_size: 172
	 GPU Preprocess time: 0.0402595 seconds
TC_Blocks:	2423307
Exp_Edges:	310183296
dynamic_shared_size: 60012
	 GPU Preprocess time: 0.548937 seconds
TC_Blocks:	26269125
Exp_Edges:	-932519296
dynamic_shared_size: 68
dimN: 1024
amazon0505
amazon0505
packing-500x100x100-b050
packing-500x100x100-b050
com-Orkut
com-Orkut
italy_osm
	 GPU Preprocess time: 0.0221971 seconds
TC_Blocks:	1344528
Exp_Edges:	172099584
Traceback (most recent call last):
  File "/scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/Baseline/DTC-SpMM/run_DTC_SpMM_h100.py", line 78, in <module>
    X = torch.ones((num_rows, dimN)).cuda()
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 25.51 GiB. GPU 0 has a total capacity of 39.50 GiB of which 12.85 GiB is free. Including non-PyTorch memory, this process has 26.64 GiB memory in use. Of the allocated memory 23.69 GiB is allocated by PyTorch, and 2.47 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
NVIDIA A100-SXM4-40GB
dimN: 1024
/home/cunyang/scratch.bhatele-lab/dataset/amazon0505/amazon0505.npz
1024-amazon0505 advisor-16.3033
1024-amazon0505 tcgnn-2.9417
1024-amazon0505 gespmm-8.3442
amazon0505 is success

/home/cunyang/scratch.bhatele-lab/dataset/packing-500x100x100-b050/packing-500x100x100-b050.npz
Subprocess failed: Traceback (most recent call last):
  File "/scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/eva/kernel/spmm/advisor/test_advisor.py", line 48, in <module>
    res = test(data, epoches, dimN, data_path)
  File "/scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/eva/kernel/spmm/advisor/test_advisor.py", line 38, in test
    execution_time = kernel(inputInfo, epoches, dataset)
  File "/scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/eva/kernel/spmm/advisor/test_advisor.py", line 11, in kernel
    X_prime, spmm_ms_avg = GNNAdvisor_kernel.forward(dataset.x, inputInfo.row_pointers, inputInfo.column_index, inputInfo.degrees, inputInfo.partPtr, inputInfo.part2Node, inputInfo.partSize, inputInfo.dimWorker, inputInfo.warpPerBlock, epoches, 10)
RuntimeError: numel needs to be smaller than int32_t max; otherwise, please use packed_accessor64

1024-packing-500x100x100-b050 advisor-100000
1024-packing-500x100x100-b050 gespmm-0.0
packing-500x100x100-b050 is success

/home/cunyang/scratch.bhatele-lab/dataset/com-Orkut/com-Orkut.npz
Subprocess failed: Traceback (most recent call last):
  File "/scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/eva/kernel/spmm/advisor/test_advisor.py", line 48, in <module>
    res = test(data, epoches, dimN, data_path)
  File "/scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/eva/kernel/spmm/advisor/test_advisor.py", line 38, in test
    execution_time = kernel(inputInfo, epoches, dataset)
  File "/scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/eva/kernel/spmm/advisor/test_advisor.py", line 11, in kernel
    X_prime, spmm_ms_avg = GNNAdvisor_kernel.forward(dataset.x, inputInfo.row_pointers, inputInfo.column_index, inputInfo.degrees, inputInfo.partPtr, inputInfo.part2Node, inputInfo.partSize, inputInfo.dimWorker, inputInfo.warpPerBlock, epoches, 10)
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 11.72 GiB. GPU 0 has a total capacity of 39.50 GiB of which 6.34 GiB is free. Process 3066420 has 20.05 GiB memory in use. Including non-PyTorch memory, this process has 13.09 GiB memory in use. Of the allocated memory 12.68 GiB is allocated by PyTorch, and 5.83 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

1024-com-Orkut advisor-100000
Traceback (most recent call last):
  File "/scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/eva/kernel/spmm/spmm_baselines.py", line 116, in <module>
    spmm_gespmm = gespmm_test(row.iloc[0], dimN, epoches, data_path)
  File "/scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/eva/kernel/spmm/spmm_baselines.py", line 36, in gespmm_test
    spmm = test_gespmm.test(data, epoches, dimN, data_path)
  File "/scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/eva/kernel/spmm/gespmm/test_gespmm.py", line 19, in test
    inputInfo.init_embedding(dimN)
  File "/scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/eva/kernel/spmm/gespmm/mdataset.py", line 54, in init_embedding
    self.x = self.x1.cuda()
RuntimeError: CUDA error: context is destroyed
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

CUDA Runtime Error: out of memory
CUDA Runtime Error: an illegal memory access was encountered
NVIDIA A100-SXM4-40GB
dimN: 1024
1024-amazon0505tcu_8_1_balance-8.99
amazon0505 is success

1024-packing-500x100x100-b050tcu_8_1_balance-32.66
packing-500x100x100-b050 is success

1024-com-Orkuttcu_8_1_balance-631.25
com-Orkut is success

1024-italy_osmtcu_8_1_balance-0.0
italy_osm is success

	 GPU Preprocess time: 0.0896154 seconds
	 GPU Preprocess time: 0.171765 seconds
	 GPU Preprocess time: 0.853915 seconds
	 GPU Preprocess time: 0.126964 seconds
Traceback (most recent call last):
  File "/scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/eva/kernel/spmm/spmm_tf32_test_args.py", line 94, in <module>
    spmm_tcu_8_1_balance = fs_tf32_8_1_balance(row.iloc[0], dimN, epoches, partsize_t, data_path,  8, 4)
  File "/scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/eva/kernel/spmm/spmm_tf32_test_args.py", line 34, in fs_tf32_8_1_balance
    spmm = test_fs.fs_tf32_8_1_balance(dataset, epoches, dimN, partsize, data_path, window,wide)
  File "/scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/eva/kernel/spmm/fs_tf32/test_fs.py", line 83, in fs_tf32_8_1_balance
    inputInfo = dataSet_tf32_balance(data, dimN, partsize_t, data_path, window, wide)
  File "/scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/eva/kernel/spmm/fs_tf32/mdataset2.py", line 64, in __init__
    self.init_edges(partsize, window, wide)
  File "/scratch/zt1/project/bhatele-lab/user/cunyang/FlashSparse/eva/kernel/spmm/fs_tf32/mdataset2.py", line 93, in init_edges
    self.t_atomicTensor, self.exe = FS_Block_gpu.preprocess_gpu_fs_balance(self.row_pointers, self.column_index, self.num_nodes, self.num_edges, window, wide,partSize)
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

slurmstepd: error: Detected 1 oom_kill event in StepId=10396616.batch. Some of the step tasks have been OOM Killed.
